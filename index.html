<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ­·å²èˆªè·¡ï¼šé„­å’Œä¸‹è¥¿æ´‹</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Leaflet CSS (åœ°åœ–) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Custom Styles -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Noto+Serif+TC:wght@700&display=swap');

        body {
            font-family: 'Noto Sans TC', sans-serif;
        }
        h1, h2, h3, .serif {
            font-family: 'Noto Serif TC', serif;
        }

        /* Leaflet Map Height */
        #map-container {
            height: 500px;
            width: 100%;
            border-radius: 0.75rem;
            z-index: 1;
        }
        
        /* å‹•ç•« */
        @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slide-up { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .animate-fade-in { animation: fade-in 0.6s ease-out forwards; }
        .animate-slide-up { animation: slide-up 0.6s ease-out forwards; }

        /* è‡ªå®šç¾©æ»¾å‹•æ¢ */
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background-color: #94a3b8; }
    </style>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
</head>
<body class="bg-slate-50 text-slate-800">

    <div id="root"></div>

    <!-- React Application Logic -->
    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useRef } from 'https://esm.sh/react@18.2.0';
        import { createRoot } from 'https://esm.sh/react-dom@18.2.0/client';
        import { Ship, Map as MapIcon, Scroll, Anchor, Package, Milestone, Info, Globe, ChevronRight, X, Users, Compass, Shield, Scale, BookOpen, Coins, Landmark, HelpCircle, FileText, Award } from 'https://esm.sh/lucide-react@0.263.1';

        // --- è³‡æ–™è¨­å®š ---

        // åœ°é»æ•¸æ“š (çœŸå¯¦ç¶“ç·¯åº¦)
        const locations = [
            { id: 1, name: "å—äº¬/åŠ‰å®¶æ¸¯", coords: [31.5, 121.2], type: "start", event: "1405å¹´é¦–èˆªå‡ºç™¼åœ°ï¼Œé€ èˆ¹åŸºåœ°ã€‚", exchange: { out: ["çµ²ç¶¢", "ç“·å™¨"], in: ["ç„¡"] } },
            { id: 2, name: "å åŸ (è¶Šå—)", coords: [13.7, 109.2], type: "stop", event: "è‰¦éšŠé¦–å€‹æµ·å¤–è£œçµ¦ç«™ï¼Œé€²è¡Œç¨»ç±³è²¿æ˜“ã€‚", exchange: { out: ["é’èŠ±ç“·"], in: ["å¥‡æ¥ æ²‰é¦™", "è±¡ç‰™"] } },
            { id: 3, name: "èˆŠæ¸¯ (å°å°¼)", coords: [-2.9, 104.7], type: "battle", event: "ç”Ÿæ“’æµ·ç›œé™³ç¥–ç¾©ï¼Œè¨­ç«‹èˆŠæ¸¯å®£æ…°å¸ã€‚", exchange: { out: ["éµå™¨", "éŠ…éŒ¢"], in: ["é¦™æ–™", "è—¥æ"] } },
            { id: 4, name: "æ»¿å‰ŒåŠ  (é¦¬ä¾†è¥¿äº)", coords: [2.2, 102.2], type: "hub", event: "å»ºç«‹å®˜å» ï¼ˆå€‰åº«ï¼‰ï¼Œæˆç‚ºæ±å—äºè²¿æ˜“æ¨ç´ã€‚", exchange: { out: ["çµ²ç¶¢"], in: ["éŒ«", "èƒ¡æ¤’", "ç‡•çª©"] } },
            { id: 5, name: "éŒ«è˜­ (æ–¯é‡Œè˜­å¡)", coords: [7.8, 80.6], type: "culture", event: "ç«‹ã€Šå¸ƒæ–½éŒ«è˜­å±±ä½›å¯ºç¢‘ã€‹ï¼Œå°Šé‡ä½›æ•™ã€‚", exchange: { out: ["é‡‘éŠ€ä¾›å™¨"], in: ["å¯¶çŸ³", "çç "] } },
            { id: 6, name: "å¤é‡Œ (å°åº¦)", coords: [11.2, 75.7], type: "hub", event: "è¥¿æ´‹å¤§åœ‹ï¼Œé„­å’Œåœ¨æ­¤ç«‹ç¢‘ç´€å¿µå‹å¥½ã€‚", exchange: { out: ["çµ²ç¶¢", "éºé¦™"], in: ["æ£‰å¸ƒ", "çŠç‘š"] } },
            { id: 7, name: "å¿½é­¯è¬¨æ–¯ (ä¼Šæœ—)", coords: [27.1, 56.4], type: "stop", event: "æ³¢æ–¯ç£å…¥å£ï¼Œæ±è¥¿æ–¹åŒ¯èšä¹‹åœ°ã€‚", exchange: { out: ["ç“·å™¨"], in: ["åœ°æ¯¯", "ç‰çŸ³"] } },
            { id: 8, name: "æœ¨éª¨éƒ½æŸ (ç´¢é¦¬åˆ©äº)", coords: [2.0, 45.3], type: "rare", event: "éæ´²æ±å²¸ï¼Œç•¶åœ°é€²è²¢é•·é ¸é¹¿ï¼ˆéº’éºŸï¼‰ã€‚", exchange: { out: ["çµ²ç¶¢", "èŒ¶è‘‰"], in: ["éº’éºŸ", "æ–‘é¦¬"] } }
        ];

        // æ¸¬é©—é¡Œç›®
        const quizQuestions = [
            { q: "é„­å’Œä¸‹è¥¿æ´‹æœ€é åˆ°é”å“ªè£¡ï¼Ÿ", options: ["æ­æ´²åœ°ä¸­æµ·", "éæ´²æ±å²¸ (æœ¨éª¨éƒ½æŸ)", "ç¾æ´²å¤§é™¸", "æ¾³æ´²"], ans: 1 },
            { q: "é„­å’Œèˆ¹éšŠå‡ºç™¼çš„æœä»£æ˜¯ï¼Ÿ", options: ["å”æœ", "å®‹æœ", "å…ƒæœ", "æ˜æœ"], ans: 3 },
            { q: "é„­å’Œä¸‹è¥¿æ´‹çš„ä¸»è¦ç›®çš„ä¹‹ä¸€æ˜¯ã€Œå®£æšåœ‹å¨ã€ï¼Œé€™ç™¼ç”Ÿåœ¨å“ªä½çš‡å¸åœ¨ä½æœŸé–“ï¼Ÿ", options: ["æ˜å¤ªç¥– æœ±å…ƒç’‹", "æ˜æˆç¥– æœ±æ££", "æ˜ç¥å®— æœ±ç¿Šéˆ", "æ˜æ€å®— æœ±ç”±æª¢"], ans: 1 },
            { q: "ä¸‹åˆ—å“ªä¸€é …ä¸æ˜¯é„­å’Œèˆ¹éšŠè¼¸å‡ºçš„ç‰©å“ï¼Ÿ", options: ["çµ²ç¶¢", "ç“·å™¨", "èŒ¶è‘‰", "é¦™æ–™ (èƒ¡æ¤’)"], ans: 3 },
            { q: "é„­å’Œå¾éæ´²å¸¶å›äº†ä»€éº¼å‹•ç‰©ï¼Œè¢«ç•¶æ™‚äººç¨±ç‚ºã€Œéº’éºŸã€ï¼Ÿ", options: ["ç…å­", "å¤§è±¡", "é•·é ¸é¹¿", "æ–‘é¦¬"], ans: 2 },
            { q: "é„­å’Œèˆ¹éšŠä½¿ç”¨çš„å°èˆªæŠ€è¡“å«åšä»€éº¼ï¼Ÿ", options: ["GPSå®šä½", "éæ´‹ç‰½æ˜Ÿè¡“", "é›·é”å°èˆª", "è²ç´æ¢æ¸¬"], ans: 1 },
            { q: "é„­å’Œåœ¨æ»¿å‰ŒåŠ ï¼ˆä»Šé¦¬ä¾†è¥¿äºé¦¬å…­ç”²ï¼‰å»ºç«‹äº†ä»€éº¼è¨­æ–½ä¿ƒé€²è²¿æ˜“ï¼Ÿ", options: ["å®˜å»  (å€‰åº«)", "é•·åŸ", "é‹æ²³", "çš‡å®®"], ans: 0 },
            { q: "é„­å’Œç¸½å…±é€²è¡Œäº†å¹¾æ¬¡ä¸‹è¥¿æ´‹çš„èˆªè¡Œï¼Ÿ", options: ["3æ¬¡", "5æ¬¡", "7æ¬¡", "10æ¬¡"], ans: 2 },
            { q: "é„­å’Œèˆ¹éšŠä¸­ï¼Œæœ€å¤§çš„èˆ¹éš»è¢«ç¨±ç‚ºä»€éº¼ï¼Ÿ", options: ["æˆ°èˆ¹", "é¦¬èˆ¹", "ç³§èˆ¹", "å¯¶èˆ¹"], ans: 3 },
            { q: "é„­å’Œä¸‹è¥¿æ´‹çµæŸå¾Œï¼Œæ˜æœå¾Œä¾†çš„æµ·æ´‹æ”¿ç­–è½‰å‘äº†ä»€éº¼ï¼Ÿ", options: ["å…¨é¢æ®–æ°‘", "æµ·ç¦æ”¿ç­–", "å·¥æ¥­é©å‘½", "è‡ªç”±è²¿æ˜“"], ans: 1 }
        ];

        // æ­·å²æ•…äº‹
        const stories = [
            {
                id: 'kirin',
                title: "éº’éºŸçš„å‚³èªª",
                icon: <Globe size={28} />,
                color: "purple",
                content: "æ¦œè‘›å‰Œåœ‹ï¼ˆä»Šå­ŸåŠ æ‹‰ï¼‰æ›¾å‘æ˜æœé€²è²¢äº†ä¸€ç¨®ç¥ç¸ï¼Œé ¸é•·ä¸ˆé¤˜ï¼Œæ–‡é‡‡çˆ›ç„¶ã€‚æ˜æœå›è‡£èªç‚ºé€™å°±æ˜¯å‚³èªªä¸­çš„ç‘ç¸ã€Œéº’éºŸã€ï¼Œè±¡å¾µç››ä¸–ã€‚å…¶å¯¦ï¼Œé€™å°±æ˜¯æˆ‘å€‘ç¾åœ¨ç†ŸçŸ¥çš„ã€Œé•·é ¸é¹¿ã€ã€‚é€™åæ˜ äº†ç•¶æ™‚ä¸­åœ‹äººå°ç•°åŸŸç”Ÿç‰©çš„å¥½å¥‡èˆ‡æ–‡åŒ–è§£è®€ã€‚"
            },
            {
                id: 'stele',
                title: "éŒ«è˜­å±±ç«‹ç¢‘",
                icon: <FileText size={28} />,
                color: "blue",
                content: "é„­å’Œåœ¨éŒ«è˜­ï¼ˆä»Šæ–¯é‡Œè˜­å¡ï¼‰å»ºç«‹äº†ä¸€å¡ŠçŸ³ç¢‘ï¼Œåç‚ºã€Šå¸ƒæ–½éŒ«è˜­å±±ä½›å¯ºç¢‘ã€‹ã€‚æœ€ç‰¹åˆ¥çš„æ˜¯ï¼Œé€™å¡Šç¢‘æ–‡åŒæ™‚ä½¿ç”¨äº†ä¸­æ–‡ã€æ³°ç±³çˆ¾æ–‡å’Œæ³¢æ–¯æ–‡ä¸‰ç¨®èªè¨€ï¼Œåˆ†åˆ¥è®šé Œä½›é™€ã€å°åº¦æ•™ç¥ç¥‡å’ŒçœŸä¸»é˜¿æ‹‰ï¼Œå±•ç¾äº†æ¥µé«˜çš„å®—æ•™åŒ…å®¹èˆ‡å¤–äº¤æ™ºæ…§ã€‚"
            },
            {
                id: 'ship',
                title: "å·¨å‹å¯¶èˆ¹ä¹‹è¬",
                icon: <Ship size={28} />,
                color: "amber",
                content: "æ ¹æ“šå²æ–™è¨˜è¼‰ï¼Œé„­å’Œçš„å¯¶èˆ¹ã€Œé•·å››åå››ä¸ˆï¼Œé—Šä¸€åå…«ä¸ˆã€ã€‚æ›ç®—æˆä»Šå¤©çš„å–®ä½ï¼Œé•·åº¦å¯èƒ½è¶…é100å…¬å°ºï¼é€™æ¯”å“¥å€«å¸ƒç™¼ç¾æ–°å¤§é™¸æ™‚çš„æ——è‰¦å¤§æ•¸å€ã€‚é›–ç„¶ç¾ä»£å°å…·é«”å°ºå¯¸æœ‰çˆ­è­°ï¼Œä½†å—äº¬å‡ºåœŸå·¨å¤§çš„ã€Œèˆµæ¡¿ã€è­‰æ˜äº†é€™äº›èˆ¹éš»ç¢ºå¯¦ä¸åƒ…é¾å¤§ï¼Œè€Œä¸”æŠ€è¡“å…ˆé€²ã€‚"
            },
            {
                id: 'pirate',
                title: "æ±ºæˆ°èˆŠæ¸¯",
                icon: <Shield size={28} />,
                color: "red",
                content: "åœ¨èˆŠæ¸¯ï¼ˆä»Šå°å°¼å·¨æ¸¯ï¼‰ï¼Œç•¶åœ°è¯äººæµ·ç›œé¦–é ˜é™³ç¥–ç¾©æ©«è¡Œéœ¸é“ï¼Œç”šè‡³è©¦åœ–è¥²æ“Šé„­å’Œèˆ¹éšŠã€‚é„­å’Œè¨­ä¸‹åŸ‹ä¼ï¼Œä¸€èˆ‰æ“Šæ½°æµ·ç›œä¸»åŠ›ï¼Œç”Ÿæ“’é™³ç¥–ç¾©ä¸¦æŠ¼å›åŒ—äº¬å—å¯©ã€‚é€™å ´æˆ°å½¹ç©©å®šäº†æ±å—äºçš„èˆªè·¯ï¼Œä¹Ÿè®“å‘¨é‚Šåœ‹å®¶å°å¤§æ˜æ°´å¸«çš„æˆ°é¬¥åŠ›æ•¬ç•ä¸å·²ã€‚"
            }
        ];

        // æ­·å²å½±éŸ¿æ•¸æ“š (è©³ç´°ç‰ˆ)
        const impacts = [
            {
                id: 'tribute',
                title: "å»ºç«‹æœè²¢é«”ç³»",
                short: "ç¢ºç«‹äº†æ˜æœåœ¨äºæ´²çš„å®—ä¸»åœ‹åœ°ä½ï¼Œè¬åœ‹ä¾†æœã€‚",
                details: [
                    "æ”¿æ²»å½±éŸ¿ï¼šå»ºç«‹äº†ä»¥æ˜æœç‚ºæ ¸å¿ƒçš„æ±äºåœ‹éš›ç§©åºï¼Œæ•¸åå€‹åœ‹å®¶å‘æ˜æœç¨±è‡£ç´è²¢ã€‚",
                    "å¤–äº¤å¾€ä¾†ï¼šå„åœ‹ä½¿ç¯€éš¨èˆ¹éšŠä¾†è¯ï¼Œæ˜æˆç¥–ç”šè‡³å…è¨±å„åœ‹åœ‹ç‹è¦ªè‡ªä¾†è¨ªï¼ˆå¦‚è˜‡ç¥¿åœ‹ç‹ï¼‰ã€‚",
                    "å’Œå¹³å¤–äº¤ï¼šé›–æœ‰å¼·å¤§æ­¦åŠ›ï¼Œä½†ä¸»è¦ä»¥å’Œå¹³æ‰‹æ®µè§£æ±ºçˆ­ç«¯ï¼ˆå¦‚èª¿è§£æš¹ç¾…èˆ‡æ»¿å‰ŒåŠ çš„çŸ›ç›¾ï¼‰ã€‚"
                ],
                color: "blue",
                icon: <Award size={28} />
            },
            {
                id: 'migration',
                title: "å—æ´‹é–‹ç™¼èˆ‡ç§»æ°‘",
                short: "ä¿ƒé€²äº†æ±å—äºï¼ˆå—æ´‹ï¼‰çš„é–‹ç™¼èˆ‡è¯äººç§»å±…æ½®ã€‚",
                details: [
                    "ç§»æ°‘æµªæ½®ï¼šéš¨èˆ¹äººå“¡åŠæ²¿æµ·å±…æ°‘å› çŸ¥æ›‰æµ·å¤–æƒ…æ³è€Œç§»å±…å—æ´‹ï¼Œå½¢æˆæ—©æœŸçš„è¯åƒ‘ç¤¾å€ã€‚",
                    "æŠ€è¡“å‚³æ’­ï¼šè¯äººå¸¶å»äº†å…ˆé€²çš„è¾²æ¥­ï¼ˆæ°´ç¨»ç¨®æ¤ï¼‰ã€æ‰‹å·¥æ¥­ï¼ˆè£½ç³–ã€æ¡ç¤¦ï¼‰æŠ€è¡“ã€‚",
                    "æ–‡åŒ–èåˆï¼šè¯äººèˆ‡ç•¶åœ°äººé€šå©šèåˆï¼Œå½¢æˆäº†ç¨ç‰¹çš„ã€Œå³‡å³‡å¨˜æƒ¹ã€æ–‡åŒ–ã€‚"
                ],
                color: "amber",
                icon: <Users size={28} />
            },
            {
                id: 'culture',
                title: "æ–‡åŒ–äº¤æµèˆ‡å‚³æ’­",
                short: "å‚³æ’­ä¸­è¯æ–‡æ˜ï¼Œäº¦å¸¶å›ç•°åŸŸæ–‡åŒ–ã€‚",
                details: [
                    "çŸ¥è­˜è¼¸å‡ºï¼šå‚³æ’­äº†ä¸­åœ‹çš„æ›†æ³•ã€åº¦é‡è¡¡ã€é†«è—¥åŠå„’å®¶æ–‡åŒ–ã€‚",
                    "è¦–é‡é–‹æ‹“ï¼šå¸¶å›äº†ã€Šé„­å’Œèˆªæµ·åœ–ã€‹ç­‰çè²´åœ°ç†è³‡æ–™ï¼Œä»¥åŠé•·é ¸é¹¿ï¼ˆéº’éºŸï¼‰ã€ç…å­ç­‰çç¸ã€‚",
                    "å®—æ•™äº¤æµï¼šé„­å’Œèº«ç‚ºç©†æ–¯æ—ï¼Œä¿ƒé€²äº†ä¼Šæ–¯è˜­ä¸–ç•Œèˆ‡ä¸­åœ‹çš„å‹å¥½äº¤æµï¼Œä¸¦å°Šé‡å„åœ°çš„ä½›æ•™ã€å°åº¦æ•™ä¿¡ä»°ã€‚"
                ],
                color: "purple",
                icon: <BookOpen size={28} />
            }
        ];

        // --- çµ„ä»¶ ---

        // 1. åœ°åœ–çµ„ä»¶ (Leaflet)
        const MapComponent = ({ onSelectLocation }) => {
            const mapContainerRef = useRef(null);
            const mapInstanceRef = useRef(null);

            useEffect(() => {
                if (!mapContainerRef.current) return;
                if (mapInstanceRef.current) return; // Prevent double init

                const map = L.map(mapContainerRef.current).setView([15, 90], 3);
                mapInstanceRef.current = map;

                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                    maxZoom: 18,
                    minZoom: 2
                }).addTo(map);

                const latlngs = locations.map(loc => loc.coords);
                const polyline = L.polyline(latlngs, {color: '#2563eb', weight: 3, dashArray: '10, 10', opacity: 0.7}).addTo(map);

                locations.forEach(loc => {
                    const marker = L.circleMarker(loc.coords, {
                        color: '#d97706', 
                        fillColor: '#f59e0b',
                        fillOpacity: 0.8,
                        radius: 8
                    }).addTo(map);

                    marker.bindPopup(`<b>${loc.name}</b>`);
                    marker.on('click', () => {
                        onSelectLocation(loc);
                    });
                    
                    marker.bindTooltip(loc.name, {permanent: true, direction: 'right', offset: [10, 0], className: 'bg-white border border-slate-300 px-1 rounded text-xs'}).openTooltip();
                });

                return () => {
                    if (mapInstanceRef.current) {
                        mapInstanceRef.current.remove();
                        mapInstanceRef.current = null;
                    }
                };
            }, []);

            return <div id="map-container" ref={mapContainerRef} className="shadow-lg border-2 border-slate-200"></div>;
        };

        // 2. ä¸»ç¨‹å¼
        const ZhengHeApp = () => {
          const [activeTab, setActiveTab] = useState('reasons');
          const [selectedLocation, setSelectedLocation] = useState(null);
          const [expandedReason, setExpandedReason] = useState(null);
          const [expandedStory, setExpandedStory] = useState(null);
          const [expandedImpact, setExpandedImpact] = useState(null); // æ–°å¢å½±éŸ¿å±•é–‹ç‹€æ…‹
          
          // æ¸¬é©—ç‹€æ…‹
          const [currentQ, setCurrentQ] = useState(0);
          const [score, setScore] = useState(0);
          const [showResult, setShowResult] = useState(false);
          const [selectedOption, setSelectedOption] = useState(null);
          const [quizStarted, setQuizStarted] = useState(false);

          // å°èˆªé¸é …
          const tabs = [
            { id: 'reasons', label: 'ä¸‹è¥¿æ´‹å‹•æ©Ÿ', icon: <Scroll size={20} /> },
            { id: 'stories', label: 'æ­·å²å‰ªå½±', icon: <BookOpen size={20} /> },
            { id: 'map', label: 'èˆªç¨‹åœ°åœ–', icon: <MapIcon size={20} /> },
            { id: 'impact', label: 'æ­·å²å½±éŸ¿', icon: <Globe size={20} /> },
            { id: 'quiz', label: 'çŸ¥è­˜æŒ‘æˆ°', icon: <HelpCircle size={20} /> },
          ];

          // è™•ç†æ¸¬é©—
          const handleAnswer = (optionIndex) => {
              setSelectedOption(optionIndex);
              if (optionIndex === quizQuestions[currentQ].ans) {
                  setScore(score + 1);
              }
              setTimeout(() => {
                  if (currentQ < quizQuestions.length - 1) {
                      setCurrentQ(currentQ + 1);
                      setSelectedOption(null);
                  } else {
                      setShowResult(true);
                  }
              }, 1000);
          };

          const resetQuiz = () => {
              setQuizStarted(false);
              setCurrentQ(0);
              setScore(0);
              setShowResult(false);
              setSelectedOption(null);
          }

          // é¡è‰²è¼”åŠ©å‡½æ•¸ (é€šç”¨æ–¼æ•…äº‹å’Œå½±éŸ¿)
          const getColorClasses = (color, isActive) => {
              const colors = {
                  purple: { activeBg: 'bg-purple-600', activeBorder: 'border-purple-600', hoverBorder: 'hover:border-purple-400', iconBg: 'bg-purple-100', iconText: 'text-purple-600', activeText: 'text-purple-100', contentBg: 'bg-purple-50', contentBorder: 'border-purple-100', contentTitle: 'text-purple-800' },
                  blue: { activeBg: 'bg-blue-600', activeBorder: 'border-blue-600', hoverBorder: 'hover:border-blue-400', iconBg: 'bg-blue-100', iconText: 'text-blue-600', activeText: 'text-blue-100', contentBg: 'bg-blue-50', contentBorder: 'border-blue-100', contentTitle: 'text-blue-800' },
                  amber: { activeBg: 'bg-amber-500', activeBorder: 'border-amber-500', hoverBorder: 'hover:border-amber-400', iconBg: 'bg-amber-100', iconText: 'text-amber-600', activeText: 'text-amber-100', contentBg: 'bg-amber-50', contentBorder: 'border-amber-100', contentTitle: 'text-amber-800' },
                  red: { activeBg: 'bg-red-600', activeBorder: 'border-red-600', hoverBorder: 'hover:border-red-400', iconBg: 'bg-red-100', iconText: 'text-red-600', activeText: 'text-red-100', contentBg: 'bg-red-50', contentBorder: 'border-red-100', contentTitle: 'text-red-800' },
              };
              return colors[color];
          };

          return (
            <div className="min-h-screen bg-slate-50 text-slate-800 pb-10">
              {/* é ‚éƒ¨ Hero å€åŸŸ */}
              <header className="relative w-full h-72 bg-gradient-to-r from-slate-100 to-white overflow-hidden flex flex-col items-center justify-center text-center px-4 shadow-sm border-b border-slate-200">
                <div className="z-10 animate-fade-in-up">
                  <div className="flex items-center justify-center gap-3 mb-3 text-amber-600">
                    <Ship size={40} />
                    <span className="tracking-[0.3em] uppercase text-sm font-bold bg-amber-100 px-3 py-1 rounded-full text-amber-800">1405 - 1433</span>
                  </div>
                  <h1 className="text-5xl md:text-6xl font-bold text-slate-800 mb-4 drop-shadow-sm tracking-wide">
                    é„­å’Œä¸‹è¥¿æ´‹
                  </h1>
                  <p className="text-slate-600 max-w-2xl mx-auto text-base md:text-lg font-medium">
                    æ¢ç´¢å¤§æ˜å¸åœ‹çš„æµ·æ´‹å‚³å¥‡ï¼šèˆªæµ·ã€è²¿æ˜“èˆ‡æ–‡åŒ–äº¤æµçš„å£¯éº—å²è©©
                  </p>
                </div>
              </header>

              {/* å°èˆªæ¬„ */}
              <nav className="sticky top-0 z-50 bg-white/95 backdrop-blur-md border-b border-slate-200 shadow-sm overflow-x-auto">
                <div className="max-w-5xl mx-auto flex min-w-max md:min-w-0 justify-center gap-2 md:gap-6 p-3">
                  {tabs.map((tab) => (
                    <button
                      key={tab.id}
                      onClick={() => setActiveTab(tab.id)}
                      className={`flex items-center gap-2 px-4 py-2.5 rounded-full transition-all duration-300 text-sm md:text-base font-medium whitespace-nowrap ${
                        activeTab === tab.id
                          ? 'bg-amber-600 text-white shadow-md scale-105'
                          : 'text-slate-600 hover:text-amber-700 hover:bg-slate-100'
                      }`}
                    >
                      {tab.icon}
                      <span>{tab.label}</span>
                    </button>
                  ))}
                </div>
              </nav>

              {/* ä¸»è¦å…§å®¹å€ */}
              <main className="max-w-6xl mx-auto p-4 md:p-8 min-h-[600px]">
                
                {/* 1. å‹•æ©Ÿæ¿å¡Š */}
                {activeTab === 'reasons' && (
                  <div className="animate-fade-in">
                    <div className="text-center mb-10">
                        <h2 className="text-3xl font-bold text-slate-800 mb-3">ç‚ºä»€éº¼è¦ä¸‹è¥¿æ´‹ï¼Ÿ</h2>
                        <p className="text-slate-500">é»æ“Šä¸‹æ–¹æŒ‰éˆ•ï¼Œæ·±å…¥äº†è§£æ˜æˆç¥–æ´¾é£é„­å’Œé èˆªçš„ä¸‰å¤§å‹•æ©Ÿ</p>
                    </div>
                    
                    <div className="grid md:grid-cols-3 gap-8">
                        {/* æ”¿æ²»å‹•æ©Ÿ */}
                        <div className="flex flex-col">
                            <button 
                                onClick={() => setExpandedReason(expandedReason === 'pol' ? null : 'pol')}
                                className={`p-6 rounded-2xl border-2 transition-all duration-300 text-left relative overflow-hidden group
                                ${expandedReason === 'pol' ? 'bg-blue-600 border-blue-600 text-white shadow-xl scale-105' : 'bg-white border-slate-200 hover:border-blue-400 hover:shadow-md'}`}
                            >
                                <div className="flex items-center gap-4 mb-2">
                                    <div className={`p-3 rounded-full ${expandedReason === 'pol' ? 'bg-white/20' : 'bg-blue-100 text-blue-600'}`}>
                                        <Anchor size={28} />
                                    </div>
                                    <h3 className="text-xl font-bold">å®£æšåœ‹å¨</h3>
                                </div>
                                <div className={`text-sm mt-2 transition-colors ${expandedReason === 'pol' ? 'text-blue-100' : 'text-slate-500'}`}>
                                    å»ºç«‹ã€Œè¬åœ‹ä¾†æœã€çš„ç››ä¸–å±€é¢... (é»æ“ŠæŸ¥çœ‹è©³æƒ…)
                                </div>
                            </button>
                            <div className={`mt-4 bg-blue-50 border border-blue-100 rounded-xl p-5 text-slate-700 leading-relaxed transition-all duration-500 overflow-hidden ${expandedReason === 'pol' ? 'max-h-96 opacity-100' : 'max-h-0 opacity-0 p-0 border-0'}`}>
                                <h4 className="font-bold text-blue-800 mb-2">è©³ç´°è§£æï¼š</h4>
                                <ul className="list-disc list-inside space-y-2">
                                    <li><strong>æ”¿æ²»åˆæ³•æ€§ï¼š</strong>æ˜æˆç¥–æœ±æ££é€šéã€Œé–é›£ä¹‹è®Šã€å¥ªä½ï¼Œæ€¥éœ€é€šéå¤–äº¤å‹åˆ©ä¾†è­‰æ˜è‡ªå·±æ˜¯å¤©å‘½æ‰€æ­¸çš„åˆæ³•çš‡å¸ã€‚</li>
                                    <li><strong>å°‹æ‰¾å»ºæ–‡å¸ï¼š</strong>å‚³è¨€å‰çš‡å¸å»ºæ–‡å¸æµäº¡æµ·å¤–ï¼Œé„­å’Œæ­¤è¡Œäº¦æœ‰ç§˜å¯†åµæŸ¥å…¶ä¸‹è½çš„ä»»å‹™ï¼Œä»¥æ¶ˆé™¤æ”¿æ²»éš±æ‚£ã€‚</li>
                                    <li><strong>å»ºç«‹æœè²¢é«”ç³»ï¼š</strong>è¦æ±‚å„åœ‹å‘æ˜æœç¨±è‡£ç´è²¢ï¼Œç¢ºç«‹æ˜æœåœ¨æ±äºåŠå°åº¦æ´‹çš„å®—ä¸»åœ‹åœ°ä½ã€‚</li>
                                </ul>
                            </div>
                        </div>

                        {/* ç¶“æ¿Ÿå‹•æ©Ÿ */}
                        <div className="flex flex-col">
                            <button 
                                onClick={() => setExpandedReason(expandedReason === 'eco' ? null : 'eco')}
                                className={`p-6 rounded-2xl border-2 transition-all duration-300 text-left relative overflow-hidden group
                                ${expandedReason === 'eco' ? 'bg-amber-500 border-amber-500 text-white shadow-xl scale-105' : 'bg-white border-slate-200 hover:border-amber-400 hover:shadow-md'}`}
                            >
                                <div className="flex items-center gap-4 mb-2">
                                    <div className={`p-3 rounded-full ${expandedReason === 'eco' ? 'bg-white/20' : 'bg-amber-100 text-amber-600'}`}>
                                        <Package size={28} />
                                    </div>
                                    <h3 className="text-xl font-bold">ç™¼å±•è²¿æ˜“</h3>
                                </div>
                                <div className={`text-sm mt-2 transition-colors ${expandedReason === 'eco' ? 'text-amber-100' : 'text-slate-500'}`}>
                                    æ¨è¡Œæœè²¢è²¿æ˜“ï¼Œäº’é€šæœ‰ç„¡... (é»æ“ŠæŸ¥çœ‹è©³æƒ…)
                                </div>
                            </button>
                            <div className={`mt-4 bg-amber-50 border border-amber-100 rounded-xl p-5 text-slate-700 leading-relaxed transition-all duration-500 overflow-hidden ${expandedReason === 'eco' ? 'max-h-96 opacity-100' : 'max-h-0 opacity-0 p-0 border-0'}`}>
                                <h4 className="font-bold text-amber-800 mb-2">è©³ç´°è§£æï¼š</h4>
                                <ul className="list-disc list-inside space-y-2">
                                    <li><strong>å®®å»·éœ€æ±‚ï¼š</strong>çš‡å®¤èˆ‡è²´æ—éœ€è¦å¤§é‡çš„æµ·å¤–å¥¢ä¾ˆå“ï¼Œå¦‚é¦™æ–™ã€å¯¶çŸ³ã€è±¡ç‰™ã€çç¦½ç•°ç¸ç­‰ã€‚</li>
                                    <li><strong>å®˜æ–¹å£Ÿæ–·ï¼š</strong>æ˜æœå¯¦è¡Œæµ·ç¦ï¼Œç¦æ­¢æ°‘é–“ç§è‡ªå‡ºæµ·ã€‚é„­å’Œä¸‹è¥¿æ´‹æ˜¯ç‚ºäº†å°‡æµ·å¤–è²¿æ˜“åˆ©æ½¤æ”¶æ­¸åœ‹æœ‰ï¼ˆã€Œåšå¾€è–„ä¾†ã€é›–è³ æœ¬ï¼Œä½†æ”¿æ²»æ„ç¾©å¤§æ–¼ç¶“æ¿Ÿåˆ©ç›Šï¼‰ã€‚</li>
                                    <li><strong>æ¨éŠ·ç”¢å“ï¼š</strong>è¼¸å‡ºä¸­åœ‹éå‰©çš„çµ²ç¶¢ã€ç“·å™¨ï¼Œæ›å–æµ·å¤–ç‰©è³‡ã€‚</li>
                                </ul>
                            </div>
                        </div>

                        {/* è»äº‹/æˆ°ç•¥å‹•æ©Ÿ */}
                        <div className="flex flex-col">
                            <button 
                                onClick={() => setExpandedReason(expandedReason === 'mil' ? null : 'mil')}
                                className={`p-6 rounded-2xl border-2 transition-all duration-300 text-left relative overflow-hidden group
                                ${expandedReason === 'mil' ? 'bg-emerald-600 border-emerald-600 text-white shadow-xl scale-105' : 'bg-white border-slate-200 hover:border-emerald-400 hover:shadow-md'}`}
                            >
                                <div className="flex items-center gap-4 mb-2">
                                    <div className={`p-3 rounded-full ${expandedReason === 'mil' ? 'bg-white/20' : 'bg-emerald-100 text-emerald-600'}`}>
                                        <Shield size={28} />
                                    </div>
                                    <h3 className="text-xl font-bold">æ‰“é€šèˆªè·¯</h3>
                                </div>
                                <div className={`text-sm mt-2 transition-colors ${expandedReason === 'mil' ? 'text-emerald-100' : 'text-slate-500'}`}>
                                    å¹³å®šæµ·è·¯ï¼Œç¶­è­·å®‰å…¨... (é»æ“ŠæŸ¥çœ‹è©³æƒ…)
                                </div>
                            </button>
                            <div className={`mt-4 bg-emerald-50 border border-emerald-100 rounded-xl p-5 text-slate-700 leading-relaxed transition-all duration-500 overflow-hidden ${expandedReason === 'mil' ? 'max-h-96 opacity-100' : 'max-h-0 opacity-0 p-0 border-0'}`}>
                                <h4 className="font-bold text-emerald-800 mb-2">è©³ç´°è§£æï¼š</h4>
                                <ul className="list-disc list-inside space-y-2">
                                    <li><strong>æ‰“æ“Šæµ·ç›œï¼š</strong>æ±å—äºæµ·åŸŸæµ·ç›œçŒ–ç—ï¼ˆå¦‚é™³ç¥–ç¾©ï¼‰ï¼Œé˜»ç¤™äº¤é€šã€‚é„­å’Œè‰¦éšŠæ“æœ‰å¼·å¤§çš„è»äº‹åŠ›é‡ï¼Œè² è²¬æ¸…å‰¿æµ·ç›œï¼Œä¿éšœèˆªè·¯æš¢é€šã€‚</li>
                                    <li><strong>æˆ°ç•¥ç‰½åˆ¶ï¼š</strong>ç•¶æ™‚ä¸­äºçš„å¸–æœ¨å…’å¸åœ‹å‹¢åŠ›å¼·å¤§ï¼Œä¸‹è¥¿æ´‹ä¹Ÿæœ‰è¯çµ¡è¥¿æ´‹å„åœ‹ï¼Œé˜²æ­¢å¸–æœ¨å…’å¸åœ‹æ±é€²çš„æˆ°ç•¥è€ƒé‡ã€‚</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                  </div>
                )}

                {/* 2. æ­·å²æ•…äº‹ */}
                {activeTab === 'stories' && (
                    <div className="animate-fade-in">
                        <div className="text-center mb-10">
                            <h2 className="text-3xl font-bold text-slate-800 mb-3">æ­·å²å‰ªå½±</h2>
                            <p className="text-slate-500">é»æ“Šä¸‹æ–¹å¡ç‰‡ï¼Œé–±è®€é—œæ–¼é„­å’Œä¸‹è¥¿æ´‹çš„ç²¾å½©æ•…äº‹</p>
                        </div>
                        
                        <div className="grid md:grid-cols-2 gap-8">
                            {stories.map((story) => {
                                const isActive = expandedStory === story.id;
                                const colors = getColorClasses(story.color, isActive);
                                
                                return (
                                    <div key={story.id} className="flex flex-col">
                                        <button 
                                            onClick={() => setExpandedStory(isActive ? null : story.id)}
                                            className={`p-6 rounded-2xl border-2 transition-all duration-300 text-left relative overflow-hidden group
                                            ${isActive ? `${colors.activeBg} ${colors.activeBorder} text-white shadow-xl scale-105` : `bg-white border-slate-200 ${colors.hoverBorder} hover:shadow-md`}`}
                                        >
                                            <div className="flex items-center gap-4">
                                                <div className={`p-3 rounded-full transition-colors ${isActive ? 'bg-white/20 text-white' : `${colors.iconBg} ${colors.iconText}`}`}>
                                                    {story.icon}
                                                </div>
                                                <h3 className="text-xl font-bold">{story.title}</h3>
                                                <div className={`ml-auto transition-transform duration-300 ${isActive ? 'rotate-90' : ''}`}>
                                                    <ChevronRight size={20} className={isActive ? 'text-white' : 'text-slate-400'} />
                                                </div>
                                            </div>
                                            <div className={`text-sm mt-2 transition-colors pl-[4.5rem] ${isActive ? colors.activeText : 'text-slate-400'}`}>
                                                {isActive ? 'é»æ“Šæ”¶èµ·' : 'é»æ“Šé–±è®€å®Œæ•´æ•…äº‹...'}
                                            </div>
                                        </button>
                                        
                                        <div className={`mt-4 rounded-xl p-6 text-slate-700 leading-loose text-justify transition-all duration-500 overflow-hidden shadow-sm
                                            ${isActive ? `max-h-96 opacity-100 ${colors.contentBg} border ${colors.contentBorder}` : 'max-h-0 opacity-0 p-0 border-0'}`}>
                                            <p className="text-lg first-letter:text-4xl first-letter:font-bold first-letter:mr-1 first-letter:float-left">
                                                {story.content}
                                            </p>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                )}

                {/* 3. èˆªç¨‹åœ°åœ– (OpenStreetMap) */}
                {activeTab === 'map' && (
                  <div className="animate-fade-in flex flex-col gap-6">
                    <div className="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                         <div className="flex flex-col md:flex-row md:items-center justify-between mb-4">
                            <div>
                                <h2 className="text-xl font-bold text-amber-700 mb-1 flex items-center gap-2">
                                    <MapIcon className="text-amber-600" /> é„­å’Œä¸‹è¥¿æ´‹äº’å‹•åœ°åœ–
                                </h2>
                                <p className="text-sm text-slate-500">ä½¿ç”¨ OpenStreetMap çœŸå¯¦åœ°ç†è³‡è¨Š | é»æ“Šåœ°åœ–ä¸Šçš„æ©™è‰²åœ“é»æŸ¥çœ‹è©³æƒ…</p>
                            </div>
                         </div>
                         
                        {/* Leaflet åœ°åœ–å®¹å™¨ */}
                        <MapComponent onSelectLocation={setSelectedLocation} />

                        {/* ä¸‹æ–¹è©³ç´°è³‡è¨Šå¡ */}
                        {selectedLocation ? (
                            <div className="bg-white border-2 border-amber-100 rounded-xl p-6 shadow-lg animate-slide-up flex flex-col md:flex-row gap-6 mt-6">
                                <div className="flex-1">
                                    <div className="flex justify-between items-center mb-3">
                                        <h3 className="text-2xl font-bold text-amber-700">{selectedLocation.name}</h3>
                                        <button onClick={() => setSelectedLocation(null)} className="md:hidden text-slate-400">
                                            <X size={24} />
                                        </button>
                                    </div>
                                    <div className="flex items-start gap-3 mb-4 bg-slate-50 p-4 rounded-lg border border-slate-200">
                                        <Milestone className="text-amber-600 shrink-0 mt-1" size={24} />
                                        <div>
                                            <h4 className="font-bold text-slate-700 mb-1">æ­·å²äº‹ä»¶</h4>
                                            <p className="text-slate-600 leading-relaxed">{selectedLocation.event}</p>
                                        </div>
                                    </div>
                                </div>

                                <div className="flex-1 border-t md:border-t-0 md:border-l border-slate-100 pt-4 md:pt-0 md:pl-6">
                                    <h4 className="font-bold text-slate-700 mb-3 flex items-center gap-2">
                                        <Package className="text-blue-600" size={20} /> è²¿æ˜“èˆ‡äº¤æµç‹€æ³
                                    </h4>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="bg-red-50 p-4 rounded-lg border border-red-100">
                                            <span className="text-xs font-bold text-red-600 block mb-2 border-b border-red-200 pb-1">ä¸­åœ‹è¼¸å‡º (Output)</span>
                                            <div className="flex flex-wrap gap-2">
                                                {selectedLocation.exchange.out.map(i => (
                                                    <span key={i} className="text-sm bg-white text-slate-700 px-2 py-1 rounded shadow-sm border border-red-100">{i}</span>
                                                ))}
                                            </div>
                                        </div>
                                        <div className="bg-emerald-50 p-4 rounded-lg border border-emerald-100">
                                            <span className="text-xs font-bold text-emerald-600 block mb-2 border-b border-emerald-200 pb-1">å¸¶å›ä¸­åœ‹ (Input)</span>
                                            <div className="flex flex-wrap gap-2">
                                                {selectedLocation.exchange.in.map(i => (
                                                    <span key={i} className="text-sm bg-white text-slate-700 px-2 py-1 rounded shadow-sm border border-emerald-100">{i}</span>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ) : (
                            <div className="bg-slate-50 border border-slate-200 border-dashed rounded-xl p-8 text-center text-slate-500 mt-6 flex items-center justify-center gap-3">
                                <Info className="animate-pulse" />
                                <p>è«‹é»æ“Šä¸Šæ–¹åœ°åœ–ä¸­çš„åœ“é»ï¼ŒæŸ¥çœ‹è©²åœ°çš„è²¿æ˜“æ´»å‹•èˆ‡æ­·å²äº‹ä»¶</p>
                            </div>
                        )}
                    </div>
                  </div>
                )}

                {/* 4. æ­·å²å½±éŸ¿ (äº’å‹•å‡ç´š) */}
                {activeTab === 'impact' && (
                    <div className="animate-fade-in space-y-6">
                         <div className="text-center mb-8">
                            <h2 className="text-3xl font-bold text-slate-800 mb-3">ä¸ƒä¸‹è¥¿æ´‹çš„æ·±é å½±éŸ¿</h2>
                            <p className="text-slate-500">é»æ“Šä¸‹æ–¹æŒ‰éˆ•ï¼Œæ¢ç´¢é€™å ´èˆªæµ·å£¯èˆ‰å¸¶ä¾†çš„æ”¹è®Š</p>
                         </div>

                         <div className="grid md:grid-cols-3 gap-6">
                           {impacts.map((item) => {
                             const isActive = expandedImpact === item.id;
                             const colors = getColorClasses(item.color, isActive);

                             return (
                                 <div key={item.id} className="flex flex-col">
                                     <button 
                                         onClick={() => setExpandedImpact(isActive ? null : item.id)}
                                         className={`p-6 rounded-xl border-t-4 transition-all duration-300 text-left relative overflow-hidden group shadow-sm
                                         ${isActive ? `${colors.activeBg} border-t-0 text-white shadow-xl scale-105` : `bg-white ${colors.hoverBorder} border-t-4 hover:shadow-md`}`}
                                         style={!isActive ? { borderColor: item.color === 'blue' ? '#3b82f6' : item.color === 'amber' ? '#f59e0b' : '#a855f7' } : {}}
                                     >
                                         <div className="flex items-center gap-3 mb-3">
                                             <div className={`transition-colors ${isActive ? 'text-white' : colors.iconText}`}>
                                                 {item.icon}
                                             </div>
                                             <h3 className="text-xl font-bold">{item.title}</h3>
                                         </div>
                                         <p className={`text-sm leading-relaxed ${isActive ? 'text-white/90' : 'text-slate-600'}`}>{item.short}</p>
                                         <div className={`text-xs mt-3 font-bold flex items-center gap-1 ${isActive ? 'text-white/80' : 'text-slate-400'}`}>
                                             {isActive ? 'é»æ“Šæ”¶èµ·' : 'é»æ“ŠæŸ¥çœ‹è©³æƒ…'} <ChevronRight size={14} className={`transition-transform ${isActive ? 'rotate-90' : ''}`} />
                                         </div>
                                     </button>
                                     
                                     <div className={`mt-4 rounded-xl p-5 text-slate-700 leading-relaxed transition-all duration-500 overflow-hidden shadow-sm
                                         ${isActive ? `max-h-96 opacity-100 ${colors.contentBg} border ${colors.contentBorder}` : 'max-h-0 opacity-0 p-0 border-0'}`}>
                                         <ul className="list-disc list-inside space-y-2">
                                             {item.details.map((detail, idx) => (
                                                 <li key={idx} className="text-sm md:text-base">
                                                     {detail}
                                                 </li>
                                             ))}
                                         </ul>
                                     </div>
                                 </div>
                             );
                           })}
                         </div>

                         <div className="bg-slate-900 text-slate-300 p-8 rounded-xl shadow-lg flex flex-col md:flex-row gap-6 items-center mt-8">
                            <div className="p-4 bg-slate-800 rounded-full shrink-0 border border-slate-700">
                                <Landmark size={40} className="text-amber-500" />
                            </div>
                            <div>
                                <h4 className="text-white text-xl font-bold mb-2">æ­·å²çš„åæ€</h4>
                                <p className="leading-relaxed text-justify">é„­å’Œä¸‹è¥¿æ´‹æ˜¯ä¸­åœ‹å¤ä»£èˆªæµ·çš„å·”å³°ï¼Œæ¯”å“¥å€«å¸ƒæ—©äº†87å¹´ã€‚ç„¶è€Œï¼Œé€™å ´å£¯èˆ‰å› èŠ±è²»å·¨å¤§ä¸”ç¼ºä¹ç¶“æ¿Ÿæ•ˆç›Šï¼Œæœ€çµ‚éš¨è‘—æ˜æœåœ‹åŠ›è¡°é€€è€Œåœæ­¢ã€‚ä¸­åœ‹éš¨å¾Œè½‰å‘ã€Œé–‰é—œé–åœ‹ã€ï¼ŒéŒ¯å¤±äº†å¤§èˆªæµ·æ™‚ä»£çš„æ©Ÿé‡ï¼Œé€™æ®µæ­·å²å€¼å¾—æˆ‘å€‘æ·±æ€é–‹æ”¾èˆ‡äº¤æµçš„é‡è¦æ€§ã€‚</p>
                            </div>
                         </div>
                    </div>
                )}

                {/* 5. çŸ¥è­˜æŒ‘æˆ° */}
                {activeTab === 'quiz' && (
                    <div className="animate-fade-in max-w-3xl mx-auto">
                        {!quizStarted ? (
                            <div className="bg-white p-10 rounded-2xl shadow-lg text-center border border-slate-200">
                                <div className="inline-block p-4 bg-amber-100 rounded-full text-amber-600 mb-6">
                                    <HelpCircle size={48} />
                                </div>
                                <h2 className="text-3xl font-bold text-slate-800 mb-4">ä½ æ˜¯é„­å’Œé€šå—ï¼Ÿ</h2>
                                <p className="text-slate-600 mb-8 text-lg">é€é 10 é“é¡Œç›®ï¼Œæ¸¬è©¦ä½ å°é„­å’Œä¸‹è¥¿æ´‹æ­·å²çš„äº†è§£ç¨‹åº¦ã€‚</p>
                                <button 
                                    onClick={() => setQuizStarted(true)}
                                    className="px-8 py-3 bg-amber-600 text-white rounded-full font-bold text-lg hover:bg-amber-700 transition-colors shadow-lg hover:shadow-xl transform hover:-translate-y-1"
                                >
                                    é–‹å§‹æ¸¬é©—
                                </button>
                            </div>
                        ) : showResult ? (
                            <div className="bg-white p-10 rounded-2xl shadow-lg text-center border border-slate-200 animate-slide-up">
                                <Award size={64} className="mx-auto text-amber-500 mb-6" />
                                <h2 className="text-3xl font-bold text-slate-800 mb-2">æ¸¬é©—å®Œæˆï¼</h2>
                                <p className="text-slate-600 mb-6">ä½ çš„å¾—åˆ†æ˜¯ï¼š</p>
                                <div className="text-6xl font-bold text-amber-600 mb-8">{score} / {quizQuestions.length}</div>
                                <p className="text-lg text-slate-700 mb-8 font-medium">
                                    {score === 10 ? "å¤ªå²å®³äº†ï¼ä½ æ˜¯èˆªæµ·ç‹ï¼ğŸ†" : score >= 7 ? "ä¸éŒ¯å–”ï¼å°é€™æ®µæ­·å²å¾ˆç†Ÿæ‚‰ï¼ğŸ‘" : "å†æ¥å†å²ï¼Œå›å»è¤‡ç¿’ä¸€ä¸‹å§ï¼ğŸ“š"}
                                </p>
                                <button 
                                    onClick={resetQuiz}
                                    className="px-6 py-2 border-2 border-slate-300 text-slate-600 rounded-full font-bold hover:bg-slate-100 hover:text-slate-800 transition-colors"
                                >
                                    é‡æ–°æ¸¬é©—
                                </button>
                            </div>
                        ) : (
                            <div className="bg-white p-8 rounded-2xl shadow-lg border border-slate-200 min-h-[400px] flex flex-col">
                                <div className="flex justify-between items-center mb-6 text-sm font-medium text-slate-400">
                                    <span>Question {currentQ + 1} / {quizQuestions.length}</span>
                                    <span>Score: {score}</span>
                                </div>
                                <div className="mb-2 h-2 w-full bg-slate-100 rounded-full overflow-hidden">
                                    <div className="h-full bg-amber-500 transition-all duration-500" style={{width: `${((currentQ + 1) / quizQuestions.length) * 100}%`}}></div>
                                </div>
                                
                                <h3 className="text-xl md:text-2xl font-bold text-slate-800 mb-8 flex-grow">
                                    {quizQuestions[currentQ].q}
                                </h3>

                                <div className="grid gap-4">
                                    {quizQuestions[currentQ].options.map((option, idx) => (
                                        <button
                                            key={idx}
                                            onClick={() => handleAnswer(idx)}
                                            disabled={selectedOption !== null}
                                            className={`p-4 rounded-xl border-2 text-left transition-all font-medium text-lg
                                                ${selectedOption === null 
                                                    ? 'border-slate-200 hover:border-blue-400 hover:bg-blue-50 text-slate-700' 
                                                    : idx === quizQuestions[currentQ].ans 
                                                        ? 'bg-green-100 border-green-500 text-green-800' 
                                                        : selectedOption === idx 
                                                            ? 'bg-red-100 border-red-500 text-red-800' 
                                                            : 'border-slate-100 text-slate-400'
                                                }
                                            `}
                                        >
                                            <div className="flex justify-between items-center">
                                                <span>{option}</span>
                                                {selectedOption !== null && idx === quizQuestions[currentQ].ans && <span className="text-green-600">âœ“</span>}
                                                {selectedOption === idx && idx !== quizQuestions[currentQ].ans && <span className="text-red-600">âœ•</span>}
                                            </div>
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>
                )}
              </main>

              {/* åº•éƒ¨ */}
              <footer className="mt-12 py-8 bg-slate-100 border-t border-slate-200 text-center">
                <p className="text-slate-500 text-sm">Â© æ­·å²æ•™å­¸äº’å‹•æ¨¡çµ„ | Designed for History Education</p>
              </footer>
            </div>
          );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<ZhengHeApp />);
    </script>
</body>
</html>
